---
title: "Práctica 2: Limpieza y validación de los datos"
author: ' Autores: César Fernández Domínguez, Isabel Fernández Esparza'
date: "Junio 2019"
output:
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
    includes:
      in_header: Practica2-header.html
  pdf_document:
    highlight: zenburn
    toc: yes
  word_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(eval=T, echo=T)
```
******
# Solución
******

## Descripción del dataset

Para la realización de esta práctica hemos seleccionado dos conjuntos de datos con información académica y personal de estudiantes de dos colegios de Portugal tanto para la asignatura de portugués como para la de matemáticas. Estos juegos de datos están disponibles en el repositorio *kaggle*, en el enlace: https://www.kaggle.com/uciml/student-alcohol-consumption

Este dataset contiene información de estudiantes de matemáticas y portugués de dos institutos portugueses. Estos estudiantes tienen una edad comprendida entre los 15 y 22 años. Creemos que este juego de datos puede ser interesante para analizar cómo afectan a los estudiantes de secundaria algunos factores como: nivel educativo de los padres, trabajo de los padres, consumo de alcohol, ditancia de los hogares de los estudiantes al colegio, tiempo de estudio semanal en los resultados académicos obtenidos.

Además, podemos analizar si existe relación entre las diferentes notas obtenidas, de manera que pueda utilizarse este estudio para futuros cursos escolares, pudiendo predecir los resultados finales a partir de los obtenidos en el primer cuatrimestre y establecer las estrategias necesarias para poder invertir esta tendencia en caso de que la haya.

Como los datos corresponden a dos colegios diferentes y con respecto a dos asignaturas distintas (matemáticas y portugués) podremos analizar también si los datos están sesgados por colegio, por asignatura o por género.

El objetivo de esta práctica es limpiar los datos, unificarlos y poder estimar un modelo que pueda predecir el número de suspensos de un estudiante de matemáticas atendiendo a los factores anteriormente descritos. Teniendo en cuenta que en el juego de datos tenemos información de dos colegios diferentes podemos también intentar analizar si las predicciones realizadas están también sesgadas por el colegio al que pertenezcan los alumnos o por el sexo.


El fichero de datos contiene 396 registros y 33 variables. Las variables de las que disponemos son:

* school: colegio al que pertenece el alumno. Tomará dos posibles valores: 'GP' - 'Gabriel Pereira' o 'MS' - 'MOusinho da Silveira' 
* sex: sexo del alumno. Tomará dos posibles valores: 'F' - Femenino o 'M' - Masculino
* age: edad del alumno. Tomará valores numéricos comprendidos entre 15 y 22 ambos incluidos
* adrress: tipo de residencia. Tomará dos posibles valores: 'R' - 'Rural' o 'U' - 'Urbana'
* family size: tamaño de la familia. Tomará dos posibles valores: 'LE3' - Menor o igual que 3 miembros o 'GT3' - Mayor de 3 miembros
* Pstatus: padres separados o no. Se representará mediante los siguientes valores: 'T' - Los padres viven juntos o 'A' - Los padres viven separados
* Medu: nivel de educación de la madre. Tomará valores numéricos: 0 - Ninguno, 1 -  Educación primaria (hasta 4º grado), 2 - De 5º a 9º grado, 3 - Educación secundaria, 4 - Educación superior
* Fedu: nivel de educación del padre. Tomará valores numéricos: 0 - Ninguno, 1 -  Educación primaria (hasta 4º grado), 2 - De 5º a 9º grado, 3 - Educación secundaria, 4 - Educación superior
* Mjob: trabajo de la madre. Tomará los valores de texto: 'teacher' - Profesora, 'health' - relacionados con los cuidades, 'services' - Servicios civiles, 'at home' - Trabaja en casa, 'Other' - Otros
* Fjob: trabajo del padre. Tomará los valores de texto: 'teacher' - Profesora, 'health' - relacionados con los cuidades, 'services' - Servicios civiles, 'at home' - Trabaja en casa, 'Other' - Otros
* reason: razón por la que se escogió ese colegio. Tomará los valores: 'home' - Cerca de casa, 'reputation' - reputación del colegio, 'course' - Preferencia de modelo educativo, 'other' - otros motivos
* guardian: tutor. Tomará los valores: 'mother' - madre, 'father' - padre, 'other' - otros
* traveltime: tiempo recorrido hasta llegar al colegio. Tomará los siguientes valores numéricos: 1 - Tarda menos de 15 minutos, 2 - Tarda entre 15 y 30 minutos, 3 - Tarda entre 30 y 60 minutos, 4 - Tarda más de una hora
* studytime: tiempo de estudio semanal del alumno. Tomará los siguientes valores numéricos: 1 - Máximo de 2 horas, 2 - de 2 a 5 horas semanales, 3 - de 5 a 10 horas semanales, 4 - Más de 10 horas semanales
* failures: numero de asignaturas suspenesas. Tomará los valores numéricos: 1 - 1 asignatura suspensa, 2 - 2 asignaturas suspensas, 3 - 3 asignaturas suspensas, 4 - más de 3 asignaturas suespensas
* schoolsup: apoyo educativo adicional. Tomará dos valores: sí o no
* famsup: disponen de ayuda en la educación en casa. Tomará dos valores: sí o no
* paid: recibe clases particulares pagadas para matemáticas o portugués en cada uno de los casos. Tomará dos valores: sí o no
* activities: actividades extraescolares. Tomará dos valores: sí o no
* nursery: acudií a guardería. Tomará dos valores: sí o no
* higher: el alumno quiere realizar estudios superiores. Tomará dos valores: sí o no
* internet: el alumno tiene internet en casa. Tomará dos valores: sí o no
* romantic: el alumno tiene pareja o no. Tomará dos valores: sí o no
* famrel: calidad de las relaciones familiares. Tomará los valores numericos de 1 a 5 siendo 1 - Muy malo y 5 - Muy bueno
* freetime: tiempo libre al salir del colegio. Tomará los valores numericos de 1 a 5 siendo 1 - Muy poco y 5 - Mucho
* goout: el alumno sale con amigos. Tomará los valores numericos de 1 a 5 siendo 1 - Muy poco y 5 - Mucho
* dalc: consumo de alcohol diario. Tomará los valores numericos de 1 a 5 siendo 1 - Muy poco y 5 - Mucho
* walc: consumo de alcohol durante el fin de semana. Tomará los valores numericos de 1 a 5 siendo 1 - Muy poco y 5 - Mucho
* health: estado de salud del alumno. Tomará los valores numericos de 1 a 5 siendo 1 - Muy malo y 5 - Muy bueno
* absences: número de ausencias del alumno. Valores numéricos comprendidos entre 0 y 93
* G1: nota en el primer trimestre. Valor numérico comprendido entre 0 y 20 
* G2: nota en el segundo trimestre. Valor numérico comprendido entre 0 y 20 
* G3: nota final. Valor numérico comprendido entre 0 y 20  

### Integración y selección de los datos de interés a realizar

En primer lugar vamos a cargar los datos con los que vamos a trabajar

```{r message= FALSE, warning=FALSE}
# Leemos los datos de los dos juegos de datos
dataMat<-read.csv("data/student-mat.csv",header=T,sep=",")
dataPor<-read.csv("data/student-por.csv",header=T,sep=",")
str(dataMat)
str(dataPor)
```
  
Vamos a ver cuántos datos tenemos de cada asignatura

```{r message= FALSE, warning=FALSE}
dim(dataPor)[1]
dim(dataMat)[1]
```

Luego vemos que, tenemos datos de `r dim(dataPor)[1]` estudiantes de portugués y datos de `r dim(dataMat)[1]`

La idea es juntar los datos de ambas asingaturas en un mismo dataset. Para ello, inicialmente vamos a crear una columna nueva en cada uno de los juegos de datos, identificando la asignatura a la que pertenece. Será una columna de tipo texto con el nombre de la asingatura a la que se refieren.

```{r message= FALSE, warning=FALSE}
# Añadimos dos columnas a cada juego de datos para identificar la asignatura a la que corresponden
# Para el juego de datos de matemáticas, la columna de matemáticas será verdadera, y para la de portugués será falsa.

dataMat$subject = "Maths"
dataPor$subject = "Portuguese"
str(dataMat)
str(dataPor)
```

Una vez que tenemos creadas estas dos columnas, podemos unir los dos dataframes para poder estudiar uno solo

```{r message= FALSE, warning=FALSE}
dataStudent = rbind(dataMat,dataPor)
str(dataStudent)
dataStudent2 = merge(dataMat, dataPor,by = c("school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery", "internet"))
str(dataStudent2)
summary(dataStudent2)
```

Luego ya tenemos integrados nuestros datos en un único dataframe llamado: dataStudent. En este dataframe vemos que hay datos del mismo alumno. Según lo que se indica en la página de kaggle, las columnas que determinan el alumno son: "school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet". Hay en total 395 estudiantes para los que tenemos información de ambas asignaturas.
```{r message= FALSE, warning=FALSE}
dataStudent2 = merge(dataMat, dataPor,by = c("school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery", "internet"))
```

### Limpieza de datos

#### ¿Los datos tienen contienen ceros o elementos vacíos? ¿Cómo gestionaríamos cada uno de estos casos?

Primero vamos a comprobar si nuestro juego de datos contiene valores vacíos.

```{r message= FALSE, warning=FALSE}
colSums(is.na(dataStudent))
```

vemos que no existen valores vacíos.

Ahora vamos a comprobar si existen valores vacíos

```{r message= FALSE, warning=FALSE}
colSums(dataStudent=="")
```

Se observa que tampoco existen valores vacíos. 

Vamos a ver ahora si existen valores con caracteres incorrectos como por ejemplo '?'

```{r message= FALSE, warning=FALSE}
colSums(dataStudent=="?")
```

Tampoco existen valores con caracteres ?

Luego como no existen ceros o elementos vacios no tenemos que hacer nada a este respecto.

#### Identificación y tratamiento de valores extremos

Los valores extremos o outliers son aquellas observaciones que están fuera de 1,5*IQR donde IQR es la diferencia entre los cuartiles 75 y 25. Para buscar los outliers en nuestro juego de datos, primero vamos a ver cuáles son las variables numéricas que tenemos en el juego de datos. Guardamos las columnas numéricas en un vector llamado dataNumerico

```{r message= FALSE, warning=FALSE}
j = 1
for (i in 1:ncol(dataStudent)){
  #print(colnames(dataStudent[i]))
  if (is.numeric(dataStudent[,i])){
    print(j)
    print(colnames(dataStudent[i]))
    dataNumerico[j] = colnames(dataStudent[i])
    j = sum(j,1)
    print(j)

  }
}
```
Utilizamos esas variables para calcular los outliers. Vamos a recorrer las diferentes variables numéricas que hemos recogido en dataNumerico para ver si tienen outliers

```{r message= FALSE, warning=FALSE}
#print(dataNumerico)
for (i in 1:length(dataNumerico)){
  outlier_values = boxplot.stats(dataStudent$dataNumerico[i])$out
  boxplot(dataStudent[,dataNumerico[i]], main=dataNumerico[i], boxwex=0.1)
  mtext(paste("Outliers: ", paste(outlier_values, collapse=", ")), cex=0.6)
}
```


Vamos a analizar los diferentes outliers para cada una de las variables numéricas:

Hemos encontrado información interesante para el tratamiento de los outliers en la siguiente dirección web

https://www.ugr.es/~fmocan/MATERIALES%20DOCTORADO/Tratamiento%20de%20outliers%20y%20missing.pdf

Variable Age: Vemos que hay un outlier en el valor 22. En este caso consideramos que este valor no debería eliminarse y deberia tratarse como uno más, probablemente el hecho de que haya alumnos de 22 años en el mismos curso que alumnos de 18 años estará relacionado con algunas de las variables que queremos analizar.

Variables Medu y Fedu: No tienen valores extremos.

Variable traveltime: Vemos que hay un outlier en el valor 4. Es decir, se dan casos extremos en los que los alumnos tardan 4 horas en llegar al colegio. Vamos a ver cuántas veces se da este valor en nuestra muestra

```{r message= FALSE, warning=FALSE}
dataStudent[dataStudent$traveltime>3,]
```

Tenemos solo 24 registros de alumnos que tardan más de 3 horas (es decir, 4) al colegio. Entendemos esta observación como consecuencia de un acontecimiento extraordinario, luego podemos prescindir de estos valores para nuestro análisis. 
```{r message= FALSE, warning=FALSE}
# Nos quedamos entonces solo con los datos de alumnos que tardan como máximo 3 horas en llegar a la escuela.
dataStudent = dataStudent[dataStudent$traveltime<=3,]
str(dataStudent)
```

Variable studytime: Tenemos outliers en el valor 4. Aunque este valos se sale de la media, la diferencia entre el resto de valores es solo de una hora, luego no nos parece que sea un outlier como tal, asi que vamos a dejarlo como está.

Variable failures: Nos ocurre lo mismo que en el caso anterior, los valores que aparecen señalados como outliers son precisamente objetos fundamentales de nuestro análisis y no debemos tratarlos como tal.

Variable famrel: Tenemos outliers en 1 y 2. Estos valores miden la calidad de las relaciones familiares, entendiendo que estos valores se han obtenido a través de una encuesta a los propios alumnos.  Estos valores tan bajos en algunas calificaciones pueden deberse a una manipulación por parte de los alumnos en las respuestas. Consideramos que una forma de tratar estos outliers es reemplazarlos por la media.
```{r message= FALSE, warning=FALSE}

```
```{r message= FALSE, warning=FALSE}
str(dataStudent)
```


Variable freetime: Existe un outlier en el valor 1

##Análisis de los datos.
Como queremos analizar cómo afectan a las notas de los alumnos sus diferentes circunstancias personales, vamos a crear una variable categórica calification, para dividir las notas numéricas entre: A, B, C y D siendo D suspenso.

```{r message= FALSE, warning=FALSE}
# Primero creamos la variable calification
dataStudent$calification <- dataStudent$G3
dataStudent$calification<-sPor$score
dataStudent$calification[(dataStudent$G3<=20) & (dataStudent$G3>=18)] <- "A"
dataStudent$calification[(dataStudent$G3<18) & (dataStudent$G3>=14)] <- "B"
dataStudent$calification[dataStudent$G3<14 & dataStudent$G3>=10] <- "C"
dataStudent$calification[dataStudent$G3<10] <- "D"
dataStudent$calification <- as.factor(dataStudent$calification)
glimpse(dataStudent)
```

### Selección de los grupos de datos que se quieren analizar/comparar

Como una primera aproximación, vamos a ver gráficamente cómo están distribuidos las calificaciones por sexo, por profesión de los padres, por colegios...

```{r message= TRUE, warning=FALSE}
ggplot(dataStudent[1:dim(dataStudent)[1],],aes(x=calification,fill=sex))+geom_bar(position="fill")+ylab("Frecuencia")
```
Y aquí vemos que, aunque están bastante uniformemente distribuidos, hay un porcentaje mayor de mujeres con buenas calificaciones que de hombres


Si ahora analizamos cómo están distribuidas las calificaciones para las asignaturas.
```{r message= TRUE, warning=FALSE}
ggplot(dataStudent[1:dim(dataStudent)[1],],aes(x=calification,fill=subject))+geom_bar(position="fill")+ylab("Frecuencia")
```

Vemos que es más frecuente suspender (obtener una D) matemáticas que portugués y que 


A continuación, veremos aquellos grupos dentro de nuestro conjunto de datos que podamos ver que son interesantes para analizar y comparar.

```{r message= FALSE, warning=FALSE}
# Agrupación por sexo
dataStudent$sex = as.factor(dataStudent$sex)
dataStudent.men <- dataStudent[dataStudent$sex == "M",]
dataStudent.women <- dataStudent[dataStudent$sex == "F",]

# Agrupación por prefesiones de los padres
dataStudent.fatherTeacher <- dataStudent[dataStudent$Fjob == "teacher",]
dataStudent.fatherHealt <- dataStudent[dataStudent$Fjob == "health",]
dataStudent.fatherServices <- dataStudent[dataStudent$Fjob == "services",]
dataStudent.fatherAtHome <- dataStudent[dataStudent$Fjob == "at_home",]
dataStudent.fatherOther <- dataStudent[dataStudent$Fjob == "other",]

dataStudent.motherTeacher <- dataStudent[dataStudent$Mjob == "teacher",]
dataStudent.motherHealt <- dataStudent[dataStudent$Mjob == "health",]
dataStudent.motherServices <- dataStudent[dataStudent$Mjob == "services",]
dataStudent.motherAtHome <- dataStudent[dataStudent$Mjob == "at_home",]
dataStudent.motherOther <- dataStudent[dataStudent$Mjob == "other",]

# Agrupación por ayudas
```


 
### Comprobación de la normalidad y homogeneidad de la varianza

QUeremos utilizar esta muestra de datos para poder predecir las calificaciones que obtendrán los alumnos según una característica. Por ejemplo, nuestra hipótesis es: un alumno que quiera realizar estudios superiores, tendrá una calificación mayor o igual a 14 puntos tanto en matemáticas como en portugués.

Para poder realizar estas pruebas paramétricas con nuestro juego de datos tenemos que analizar si los datos referentes a la calificación final siguen una distribución normal.

Existen diferentes pruebas de normalidad que podemos llevar a cabo para realizar estos estudios:

- Pruebas gráficas basadas en gráficos de normalidad como Q Q_Plots. Podríamos calcular la normalidad sobre todas las variables numéricas. Los análisis e hipótesis que estamos barajando se centran en las notas de los alumnos, luego vamos a revisar si las variables de notas: G1, G2 y G3 están normalizadas
```{r message= FALSE, warning=FALSE}
# Usamos el test de Saphiro Wilk para analizar la normalidad de estas variables
shapiro.test(dataStudent$G1)
```

Vemos que el valor de p es menor que 0,05 luego tenemos una distribución que no es normal

```{r message= FALSE, warning=FALSE}
# Usamos el test de Saphiro Wilk para analizar la normalidad de estas variables
shapiro.test(dataStudent$G2)
```

Tampoco tenemos una distribución normal

```{r message= FALSE, warning=FALSE}
# Usamos el test de Saphiro Wilk para analizar la normalidad de estas variables
shapiro.test(dataStudent$G3)
```

Tampoco tenemos una distribución normal.

Ahora vamos a comprobar la normalidad de estos mismos valores utilizando el test de Anderson-Darling

```{r message= FALSE, warning=FALSE}
# Usamos el test de Anderson-Darling para analizar la normalidad de estas variables
ad.test(dataStudent$G1)
ad.test(dataStudent$G2)
ad.test(dataStudent$G3)
```

Nuevamente vemos que el valor de p es menor que 0,05 para los tres casos luego como en caso anterior no siguen una distribución
normal

Veamos ahora los resultados que obtenemos con el test de Cramer-von Mises

```{r message= FALSE, warning=FALSE}
# Usamos el test de Cramer-von Mises para analizar la normalidad de estas variables
cvm.test(dataStudent$G1)
cvm.test(dataStudent$G2)
cvm.test(dataStudent$G3)
```

Obtenemos los mismos resultados

Por último, vamos a verificar que obtenemos lo mismo con el test de Kolmogorov

```{r message= FALSE, warning=FALSE}
# Usamos el test de Anderson-Darling para analizar la normalidad de estas variables
lillie.test(dataStudent$G1)
lillie.test(dataStudent$G2)
lillie.test(dataStudent$G3)
```

Obtenemos los mismos resultados

## Estudio de homogeneidad de la varianza

Teniendo en cuenta que en el apartado anterior hemos visto que los datos no siguen una distribución normal, lo más recomendable para estudiar la homogeneidad de la varianza es utilizar tests que comparen la mediana de la varianza, por ejemplo el test de Levene 
```{r message= FALSE, warning=FALSE}
library(car)
leveneTest(y = dataStudent$G1, group = dataStudent$sex, center = "median")
leveneTest(y = dataStudent$G2, group = dataStudent$sex, center = "median")
leveneTest(y = dataStudent$G3, group = dataStudent$sex, center = "median")
```

Vemos que el valor de p es mayor que 0,05 para todos los casos, luego podemos inferir que las varianzas de la distribución de las notas para el primer trimestre, el segundo y la calificación final para hombres o mujers es la misma.

Vamos ahora a analizar la homogeneidad de la varianza de las notas de los estudiantes atendiendo a los niveles de estudios de los padres (Medu y Fedu)

```{r message= FALSE, warning=FALSE}
leveneTest(y = dataStudent$G1, group = dataStudent$Medu, center = "median")
leveneTest(y = dataStudent$G2, group = dataStudent$Medu, center = "median")
leveneTest(y = dataStudent$G3, group = dataStudent$Medu, center = "median")
```

Vemos que para las notas del primer y segundo trimestre las varianzas no son homogéneas para los grupos de estudiantes cuyas madres tienen diferentes niveles de estudios, sin embargo el valor de p para el test realizado con las pruebas finales es mayor que 0,05 luego en ese caso las varianzas si se distribuyen homogéneamente.

Para el caso de los niveles de estudios de los padres

```{r message= FALSE, warning=FALSE}
leveneTest(y = dataStudent$G1, group = dataStudent$Fedu, center = "median")
leveneTest(y = dataStudent$G2, group = dataStudent$Fedu, center = "median")
leveneTest(y = dataStudent$G3, group = dataStudent$Fedu, center = "median")
```

Vemos que en este caso las varianzas si son homogéneas para los distintos niveles de estudios de los padres

## Aplicación de pruebas estadísticas para comparar los grupos de datos. Aplicar pruebas de contrastes de hipótesis, regresiones, correlaciones,...

En este juego de datos vemos que tenemos tres notas numéricas: G1 correspondiente al primer trimestre, G2 correspondiente al segundo y G3 la calificación final. Parece lógico pensar que existe relación entre estas notas. Veamos si, efectivamente estamos en lo cierto en nuestra hipótesis, y estas 3 variables están correlacionadas.

Primero vamos a ver si están relacionadas G1 y G2. Como hemos visto que estas variables no siguen una distribución normal, vamos a utilizar el método de correlación de Spearman para estudiar la correlación entre estas dos variables.

```{r message= FALSE, warning=FALSE}
# Primero vamos a representar las dos variables en un diagrama de dispersión para ver si ya visualmente se puede intuir si existe relación lineal. 

ggplot(data = dataStudent, aes(x = dataStudent$G1, y = dataStudent$G2)) + 
  geom_point(colour = "red4") +
  ggtitle("Diagrama de dispersión 1er trimestre vs segundo trimestre") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(data = dataStudent, aes(x = dataStudent$G1, y = dataStudent$G3)) + 
  geom_point(colour = "red4") +
  ggtitle("Diagrama de dispersión 1er trimestre vs final") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(data = dataStudent, aes(x = dataStudent$G2, y = dataStudent$G3)) + 
  geom_point(colour = "red4") +
  ggtitle("Diagrama de dispersión segundo trimestre vs final") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))


```

Luego, a la vista de estos diagramas, parece intuirse que existe una posible relación lineal entre las notas de cada trimestre.

Como ya hemos visto que estas variables no siguen una distribución normal, vamos a analizar la correlación utilizando el test de Spearman

```{r message= FALSE, warning=FALSE}
cor(x = dataStudent$G1, y = log10(dataStudent$G2), method = "spearman")
cor(x = dataStudent$G1, y = log10(dataStudent$G3), method = "spearman")
cor(x = dataStudent$G2, y = log10(dataStudent$G3), method = "spearman")
```

Vemos que para los 3 casos el grado de correlación es alto (mayor que 0,8). Pero para poder realmente considerar que existe correlación entre las variables debemos calcular la significancia

```{r message= FALSE, warning=FALSE}
# https://rpubs.com/Joaquin_AR/223351
cor.test(x = dataStudent$G1,
         y = log10(dataStudent$G2),
         alternative = "two.sided",
         conf.level  = 0.95,
         method      = "spearman")

cor.test(x = dataStudent$G1,
         y = log10(dataStudent$G3),
         alternative = "two.sided",
         conf.level  = 0.95,
         method      = "spearman")

cor.test(x = dataStudent$G2,
         y = log10(dataStudent$G3),
         alternative = "two.sided",
         conf.level  = 0.95,
         method      = "spearman")
```

Vemos que, para los tres casos, los coeficientes de correlación son significativos puesto que p está próximo a 0 en los tres casos.

## Regresión logística
Imaginemos que queremos realizar un estudio para establecer un modelo que permita calcular cuál es la probabilidad de predecir que un estudiante ha recibido ayuda extraescolar (schoolsup) en función de la nota final que ha obtenido

En primer lugar vamos a representar las observaciones para poder intuir gráficamente si la varibale escogida (la nota de G3) está relacionada con la variable respuesta (obtienen ayuda escolar) y puede considerarse que es un buen predictor

```{r message= FALSE, warning=FALSE}
library(ggplot2)
ggplot(data = dataStudent, aes(x = dataStudent$schoolsup, y = dataStudent$G3, color = schoolsup)) +
  geom_boxplot(outlier.shape = NA) +
  geom_jitter(width = 0.1) +
  theme_bw() +
  theme(legend.position = "null")
```

Parece que hay diferencias entre la distribución de las notas para alumnos que reciban ayuda.

Ahora vamos a generar el modelo

```{r message= FALSE, warning=FALSE}
modelo <- glm(dataStudent$schoolsup ~ dataStudent$G3, data = dataStudent, family = "binomial")
summary(modelo)
```



